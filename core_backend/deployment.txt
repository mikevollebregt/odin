sudo systemctl start kestrel-odin_production
sudo systemctl stop kestrel-odin_production.service

sudo cp -r /odin/core_backend/bin/Debug/net6.0/publish/* /var/www/odin_production
dotnet publish -c Debug
gcloud compute firewall-rules create allow-http-dev --allow=tcp:5001
gcloud compute firewall-rules create allow-https-dev --allow=tcp:443

cat <<EOF > kestrel-odin_production.service
[Unit]
Description=Odin production

[Service]
WorkingDirectory=/var/www/odin_production
ExecStart=/usr/bin/dotnet /var/www/odin_production/core_backend.dll
Restart=always
Environment=ASPNETCORE_ENVIRONMENT=Development
Environment=ASPNETCORE_URLS=https://0.0.0.0:5000

[Install]
WantedBy=multi-user.target
EOF

gcloud compute instances get-serial-port-output odin-production
